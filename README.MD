This is a readmq implemented from scratch
